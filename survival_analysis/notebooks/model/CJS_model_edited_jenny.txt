model {
  b0 ~ dnorm(0, 1/100)
  for (j in 1:J) {
    b1[j] ~ dnorm(0, 1/100)
  }
  phi[1] <- 1
  p[1] <- 1
  for (j in 2:J) {
    phi[j] ~ dbeta(1, 1)
    p[j] ~ dbeta(1, 1)
  }
  for (i in 1:N) {
    for (j in (f[i] + 1):J) {
      ilogit(logit(phi[i])) <- b0 + b1[j] * y[i, 1]
      z[i, j] ~ dbern(phi[j] * z[i, j - 1])
      y[i, j] ~ dbern(p[j] * z[i, j])
    }
  }
}
