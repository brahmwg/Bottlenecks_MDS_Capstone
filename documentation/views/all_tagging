 SELECT 'hatch_tag'::text AS source,
    hatch_tag.tray AS pit_tray,
    hatch_tag.system AS river,
    hatch_tag.species,
    hatch_tag.cohort,
    hatch_tag.outmigration_y::integer AS year,
    hatch_tag.hex,
    hatch_tag.tag_id_long,
    COALESCE(hatch_tag.tagging_date, hatch_tag.date_time_release::date) AS date,
    hatch_tag.fork_length_mm::integer AS fork_length_mm,
    hatch_tag.origin,
    hatch_tag.clip_status,
    hatch_tag.release_latitude,
    hatch_tag.release_longitude,
    NULL::text AS site,
    NULL::text AS method,
    NULL::text AS whatman_concat_ck,
    NULL::text AS whatman_concat_co,
    NULL::text AS project,
    NULL::text AS latregion,
    NULL::text AS pfma,
    hatch_tag.system AS stock,
    NULL::double precision AS prob,
    NULL::text AS stock_group,
    NULL::text AS species_id,
    NULL::text AS year_class,
    NULL::text AS genetic_source,
    NULL::text AS whatman_sheet,
    NULL::text AS whatman_no
   FROM ods.hatch_tag
UNION ALL
 SELECT field.river_or_estuary AS source,
    field.pit_tray,
    field.river,
    field.species,
    NULL::text AS cohort,
    field.year,
    NULL::text AS hex,
    field.tag_id_long,
    field.date,
    field.fork_length_mm,
    NULL::text AS origin,
    field.clip_status,
    NULL::text AS release_latitude,
    NULL::text AS release_longitude,
    field.site,
    field.method,
    field.whatman_concat_ck,
    field.whatman_concat_co,
    NULL::text AS project,
    NULL::text AS latregion,
    NULL::text AS pfma,
    COALESCE(field.stock, field.watershed) AS stock,
    NULL::double precision AS prob,
    NULL::text AS stock_group,
    NULL::text AS species_id,
    NULL::text AS year_class,
    NULL::text AS genetic_source,
    NULL::text AS whatman_sheet,
    NULL::text AS whatman_no
   FROM ods.field
  WHERE field.tag_status = 'tag'::text
UNION ALL
 SELECT 'microtroll'::text AS source,
    microtroll.pit_tray,
    microtroll.general_location AS river,
    microtroll.species,
    NULL::text AS cohort,
    EXTRACT(year FROM microtroll.date::date) AS year,
    NULL::text AS hex,
    microtroll.tag_id_long,
    microtroll.date::date AS date,
    microtroll.fork_length_mm,
    NULL::text AS origin,
    microtroll.clip_status,
    NULL::text AS release_latitude,
    NULL::text AS release_longitude,
    NULL::text AS site,
    NULL::text AS method,
    concat(microtroll.whatman_sheet, '-', microtroll.whatman_no) AS whatman_concat_ck,
    concat(microtroll.whatman_sheet, '-', microtroll.whatman_no) AS whatman_concat_co,
    microtroll.project,
    microtroll.latregion,
    microtroll."PFMA"::text AS pfma,
    microtroll."Stock" AS stock,
    microtroll."Prob" AS prob,
    microtroll."Stock_Group" AS stock_group,
    microtroll."species_ID" AS species_id,
    microtroll."Year_Class" AS year_class,
    microtroll."Genetic_Source" AS genetic_source,
    microtroll.whatman_sheet,
    microtroll.whatman_no
   FROM ods.microtroll
  WHERE microtroll.tag_status = 'tag'::text;
