 SELECT at.system,
    at.species,
    at.year,
    at.period,
    at.count AS tags_deployed,
    COALESCE(sum(sor.sum_outmigrant), 0::numeric) AS detected_outmigrating,
    COALESCE(sum(sor.sum_return), 0::numeric) AS detected_return,
    COALESCE(sum(sr.total_recaps), 0::numeric) AS total_recaps
   FROM ods.summary_all_tagging at
     LEFT JOIN ods.summary_outmigrant_and_return2 sor ON at.system = sor.system AND at.species = sor.species AND at.year = sor.year AND at.period = sor.period
     LEFT JOIN ods.summary_recaps sr ON at.system = sr.system AND at.species = sr.species AND at.year = sr.year AND at.period = sr.period
  GROUP BY at.system, at.species, at.year, at.period, at.count
  ORDER BY at.system, at.species, at.year, at.period;
