 SELECT at.system,
    at.species,
    at.year,
    at.period,
    at.count AS tags_deployed,
    COALESCE(sum(sor.sum_outmigrant), 0::numeric) AS detected_outmigrating,
    COALESCE(sum(sor.sum_return), 0::numeric) AS detected_return
   FROM ods.summary_all_tagging2 at
     LEFT JOIN ods.summary_outmigrant_and_return3 sor ON at.system = sor.system AND at.species = sor.species AND at.year = sor.year AND at.period = sor.period
  GROUP BY at.system, at.species, at.year, at.period, at.count
  ORDER BY at.system, at.species, at.year, at.period;
